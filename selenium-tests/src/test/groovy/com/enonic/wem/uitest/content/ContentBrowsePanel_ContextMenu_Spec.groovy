package com.enonic.wem.uitest.contentimport com.enonic.autotests.pages.contentmanager.browsepanel.ContentBrowsePanelimport com.enonic.autotests.services.NavigatorHelperimport com.enonic.autotests.utils.NameHelperimport com.enonic.autotests.vo.contentmanager.Contentimport com.enonic.wem.uitest.BaseGebSpecimport com.enonic.xp.content.ContentPathimport com.enonic.xp.schema.content.ContentTypeNameimport spock.lang.Sharedclass ContentBrowsePanel_ContextMenu_Spec    extends BaseGebSpec{    @Shared    ContentBrowsePanel contentBrowsePanel;    def setup()    {        go "admin"        contentBrowsePanel = NavigatorHelper.openContentApp( getTestSession() );    }    def "GIVEN a content WHEN content selected and 'Delete' selected from context menu  THEN content not exist in view"()    {        setup: "build a new folder-content"        String name = NameHelper.uniqueName( "folder" );        Content content = Content.builder().            name( name ).            displayName( "folderToDelete" ).            contentType( ContentTypeName.folder() ).            parent( ContentPath.ROOT ).            build();        and: "add new content: click on 'new' button, populate a wizard and close it"        contentBrowsePanel.clickToolbarNew().selectContentType( content.getContentTypeName() ).typeData( content ).save().close(            content.getDisplayName() );        contentBrowsePanel.waitsForSpinnerNotVisible();        when: "right clicks on the selected folder and select 'Delete' from the context menu"        contentBrowsePanel.selectDeleteFromContextMenu( content.getPath() ).doDelete();        contentBrowsePanel.waitUntilPageLoaded( 3 );        then: "content deleted and  not exist in view"        !contentBrowsePanel.exists( content.getPath(), true );    }    def "GIVEN a content WHEN content selected and 'Edit' selected from context menu  THEN content is listed with it's new name"()    {        setup: "builds a new folder-content"        String name = NameHelper.uniqueName( "folder" );        Content content = Content.builder().            name( name ).            displayName( "folder" ).            contentType( ContentTypeName.folder() ).            parent( ContentPath.ROOT ).            build();        and: "add new content: click on 'new' button, populate a wizard and close it"        contentBrowsePanel.clickToolbarNew().selectContentType( content.getContentTypeName() ).typeData( content ).save().close(            content.getDisplayName() );        contentBrowsePanel.waitsForSpinnerNotVisible();        Content newContent = cloneContentWithNewName( content )        when: "right clicks on the selected folder and select 'Edit' from the context menu, populate a new data and save it"        contentBrowsePanel.selectEditFromContextMenu( content.getPath() ).typeData( newContent ).save().close(            newContent.getDisplayName() );        contentBrowsePanel.waitUntilPageLoaded( 3 );        then: "content is listed with it's new name"        contentBrowsePanel.exists( newContent.getPath(), true );    }    def "GIVEN a content WHEN content selected and 'New' selected from a context menu THEN new Content should be listed beneath parent"()    {        setup: "builds a new archive-content"        String name = NameHelper.uniqueName( "folder" );        Content content = Content.builder().            name( name ).            displayName( "folder-parent" ).            contentType( ContentTypeName.folder() ).            parent( ContentPath.ROOT ).            build();        and: "add new content: click on 'new' button, add a new content"        contentBrowsePanel.clickToolbarNew().selectContentType( content.getContentTypeName() ).typeData( content ).save().close(            content.getDisplayName() );        contentBrowsePanel.waitsForSpinnerNotVisible();        and: "builds a new folder content, that will be child for first content"        Content newContent = Content.builder().            name( "childfolder" ).            displayName( "folder-child" ).            parent( ContentPath.from( name ) ).            contentType( ContentTypeName.folder() ).            build();        when: "right clicks on the first content and select 'New' from the context menu, populate content wizard and save"        contentBrowsePanel.selectNewFromContextMenu( content.getPath() ).selectContentType( newContent.getContentTypeName() ).typeData(            newContent ).save().close( newContent.getDisplayName() );        contentBrowsePanel.waitUntilPageLoaded( 3 );        contentBrowsePanel.expandContent( content.getPath() );        then: "new Content should be listed beneath parent"        contentBrowsePanel.exists( newContent.getPath(), true );    }    Content cloneContentWithNewName( Content source )    {        String newName = NameHelper.uniqueName( "newname" );        return Content.builder().            name( newName ).            displayName( source.getDisplayName() ).            parent( source.getParent() ).            contentType( source.getContentTypeName() ).            build();    }}